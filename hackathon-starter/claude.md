# Game Results Tracking Platform - Development Guide

This document provides guidelines for working on the Game Results Tracking Platform project, especially when using Claude or other LLM assistants.

## Project Overview

We're building a game results tracking platform that allows users to track game results across different types of games (video games, table games, card games) with scoreboards and player rankings.

The project is built with:
- Next.js for the frontend and API routes
- MongoDB for data persistence
- Mongoose as the ODM
- Jest for testing

## Development Approach

### Test-Driven Development (TDD)

We follow a Test-Driven Development approach:

1. **Write tests first**: Before implementing any feature, write tests that define the expected behavior.
2. **Run tests to see them fail**: Ensure your tests fail initially (red phase).
3. **Implement the feature**: Write the minimum code needed to make the tests pass.
4. **Run tests to see them pass**: Verify your implementation works (green phase).
5. **Execute all tests**: After adding new feature, run all tests using `npm run test` and make sure all tests are green.
6. **Refactor**: Clean up your code while ensuring tests still pass.

### Git Workflow

We use feature branches and small, incremental commits:

1. **Create feature branches**: Always work on a feature branch (e.g., `team-one`, `feature/user-model`).
2. **Make small, focused commits**: Each commit should represent a single logical change.
3. **Write descriptive commit messages**: Clearly explain what changes were made and why.
4. **Create checkpoints**: Commit frequently to create checkpoints you can revert to if needed.

## Project Architecture

The project follows a layered architecture:

1. **API Layer**: Next.js API routes handle HTTP requests and responses.
2. **Service Layer**: Business logic and operations.
3. **Data Access Layer**: Database operations using Mongoose models.
4. **Storage Layer**: MongoDB for data and file storage for images.

## Data Models

The core data models are:

1. **User Model**: Stores user information (username only for MVP).
2. **Game Model**: Represents games that can be tracked (name, type, image URL).
3. **Game Result Model**: Records results of game sessions (players, scores, timestamp).
4. **Scoreboard Model**: Derived model for player rankings.

## Directory Structure

```
hackathon-starter/
├── app/                  # Next.js app directory
│   ├── api/              # API routes
│   └── ...               # Page components
├── components/           # React components
├── lib/                  # Library code
│   ├── db/               # Database related code
│   │   ├── models/       # Mongoose models
│   │   ├── utils/        # Database utilities
│   │   └── __tests__/    # Database tests
│   └── ...               # Other utilities
├── public/               # Static assets
└── ...                   # Configuration files
```

## Working with LLMs (Claude, etc.)

When using Claude or other LLMs to assist with development:

1. **Provide context**: Share the architecture document and relevant files.
2. **Follow TDD**: Ask the LLM to help write tests before implementation.
3. **Request incremental changes**: Ask for small, focused changes rather than large implementations.
4. **Verify generated code**: Always review and test code generated by LLMs.
5. **Explain project conventions**: Inform the LLM about our ESM setup, testing approach, etc.

## Environment Setup

1. **MongoDB**: The project uses MongoDB for data storage. For development, we use mongodb-memory-server for tests.
2. **Environment Variables**: Copy `.env.example` to `.env.local` and update as needed.
3. **Node.js**: We use ES modules (`"type": "module"` in package.json).

## Testing

1. **Unit Tests**: Test individual components and functions.
2. **Integration Tests**: Test interactions between components.
3. **API Tests**: Test API endpoints.

Run tests with:
```bash
npm test
```

For specific tests:
```bash
npm test -- path/to/test/file
```

## Troubleshooting

If you encounter issues with ESM modules in tests, try:
1. Use `.mjs` extension for ES modules
2. Use the test script in `lib/db/utils/test-user-model.mjs` as a reference